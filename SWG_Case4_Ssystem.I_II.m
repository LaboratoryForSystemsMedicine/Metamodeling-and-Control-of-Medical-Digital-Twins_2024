
Par=[3103.16256846100 0 0 0
    3.16242649221822e-05 1 1 0
    1.34894947218148e-06 1 1 0
    9.61318512727303e-06 0 1 1
    1.42374154198437e-05 0 1 1
    0.0576167891146790 0 0 1]
Par=[300; Par(:)];

% Par=[300.966077017083;3272.94972063274;3.05837567094998e-05;1.32991758519970e-06;1.08554536148306e-05;1.36275148016374e-05;0.0553713852643778;0.000130857624020216;1.00850449033046;0.881495352079718;0.000272671701837728;-1.70708624000789e-05;0.000109682933583058;-0.000357137714198314;1.00062627502178;1.12418442140644;0.969492991217172;1.00541571934889;-0.000148574772302551;-0.000195293276174410;6.81345461019282e-05;-0.000335743571025745;1.06934559323432;0.995754782652618;1.00003368005875]
% Par=[300.986348746679;3297.44859118151;3.11744047940134e-05;1.34563534397774e-06;1.21769603785296e-05;1.39476076557607e-05;0.0517368329001804;-0.00259449921400337;1.00820083978536;0.856721286509942;0.00531592936972312;-3.59199192916824e-05;-0.000333395916519241;-0.00144586790231813;0.994748851618933;1.16913089346209;0.940101951964064;0.977632842189220;-0.000639378394661500;-0.000378920792644405;0.000329701198308037;0.00135783638681850;1.09890539319407;0.997906689093035;0.984875668988842]
% Par=[445.963186078341;3339.34382162756;3.17166043813909e-05;1.38245064437124e-06;1.27443807821012e-05;1.41037858934687e-05;0.0525866565852862;-0.00474107569101049;1.00870417234360;0.864872952232674;-0.00401925332700892;-0.000307324274755839;-0.000971855817846187;4.80428257001275e-05;0.994138679344432;1.15154944297903;0.970621299728845;0.979277210155212;-0.00217769673531252;-0.00116644863034006;-0.00238521587048158;0.0104916870634668;1.07669804385556;0.997035868311728;0.987380444604883]
% Par=[1055.077971117490;3493.63529016128;3.28393299876444e-05;1.72374070606314e-06;1.39401200316920e-05;1.45767838087020e-05;0.0547895980019650;-0.00487674144425556;1.01157834619593;0.867286898566894;-0.00829011288551437;-0.000674113921651036;-0.00200790138129524;-0.000339939715287122;0.993039122232913;1.12257787931699;0.991869667991751;0.976924785205953;-0.00234236574789663;-0.000107805012013549;-0.00315441267648247;0.0149075108974033;1.05207701406827;0.993435706139045;0.981177149518766]
% Par=[982.102326088883;3502.07351765450;3.33966442292264e-05;1.70883550482034e-06;1.45431840042382e-05;1.45916690286380e-05;0.0544078143627924;-0.00443697791009606;1.01173021789336;0.866408858232436;-0.00789241336876991;-0.000724329706527201;-0.00191141713641751;-0.000411825058887814;0.992248929794789;1.12020015901997;1.00251568249278;0.975454615954679;-0.00233693614100415;-0.000108079958103862;-0.00275894308998934;0.0149785900514657;1.02692925079570;0.993433136354581;0.979387623813799]
% Par=[1202.80885672049;4222.75343171195;4.02786082038519e-05;1.81713536156878e-06;1.29378607502973e-05;1.51940235436303e-05;0.0614779674012661;-0.00517316963228407;1.01589734864055;0.879027302559343;0.0715331038443182;-0.0289828773372506;-0.00353892022207343;0.0258855646905858;0.997261365521475;1.08102352031364;0.945104706809944;0.990118903827337;-0.0166947777121295;0.000588591387957856;0.0145627398986899;0.0482770408260104;1.01502631331701;0.998069931446858;0.969569319923069]
% 
% Par=[1261.53248434907;4067.62808487807;3.93135168084790e-05;1.46613686647764e-06;6.15251261762142e-06;1.42999570159000e-05;0.0609591663622712;-0.00673253743325141;1.01420554070000;0.859328897410126;0.123087790045609;-0.0331448870308330;-0.00321384648971024;0.0278072578937289;0.996337691976035;1.12665288818122;0.946725630580979;0.997743973188721;-0.0154594715637013;0.000366076239575611;0.0147195510732499;0.0529502767784519;1.04777702571885;1.00300470408932;0.969747226079125]
% Par=[1461.07498064489;3748.17781443803;3.88653646153163e-05;1.31452473826552e-06;5.53492285661390e-06;1.27195862072487e-05;0.0607562008747658;-0.00338876922270415;1.01279867143190;0.847159556484945;0.128436360008571;-0.0332416677687590;-0.0132104832725018;0.0201355392372896;0.989200127947886;1.19453892641933;0.940561961233835;0.987969554329923;-0.0198344010936881;0.000132266970237397;0.0107175049455391;0.0253958303193139;1.07664585528356;1.00244332387548;0.961661539552940]
% Par=[1528.98639355957;3723.38030692916;4.00000585026554e-05;1.48341053657573e-06;5.64217961141822e-06;1.27723957459561e-05;0.0586109338634355;-0.00242100020181368;1.01559476401973;0.854492747876454;0.122432696664691;-0.0406932483551071;-0.0129245795836353;0.0212383210642648;0.986702841504436;1.18778925349690;0.961461682167919;0.983738977615600;-0.0182670317053589;0.000161065682918917;0.00745778572644960;0.0199032331363439;1.07362314056859;1.00167458931300;0.949508165710371]

% Par=[317.660359614731;2800.84805455085;3.18045207132672e-05;1.31403340484230e-06;1.01233293244880e-05;1.37734002941975e-05;0.0541365256822737;8.81454854592191e-05;0.994810618657997;0.946399733669976;0.000331434906313946;7.57286580024751e-05;-0.000549556200217201;3.62979325068308e-05;0.994683057876793;1.04486822084955;0.902509800541259;0.989146679926482;5.53013887764407e-06;0.000643202851532782;0.000292703780582105;-0.000210979810406417;1.15033292133569;1.00123537836040;0.992903631882301]
Par=[707.898797713976,-0.131322619148285,0.0652059903326178,0.138430231017208
    2.74290709712722e-05,1.01002513278854,0.915235668006856,-0.0624222334509402
    1.18449032179785e-06,0.937497531445507,0.988680344035039,0.0585716046376420
    2.47724294281499e-06,-0.00313911396964099,1.43529013066231,0.660600296309528
    1.08954552559593e-05,0.0379856779311007,0.998693159011258,1.03520222002640
    0.129450032776724,0.00216129790049945,0.00973677896764006,0.942070121122811]
Par=[1150; Par(:)];

Par=[1162.00192769509;721.255881878251;2.63464673389454e-05;1.18514308318600e-06;2.56496721073224e-06;1.09385918511771e-05;0.133192149528849;-0.119377328268411;1.02668039580372;0.936747658403511;-0.00332969922013483;0.0379112458930731;0.00227446076061804;0.0630899963236659;0.910384734833535;1.00201167146402;1.44876306619622;1.01781982633552;0.00859180499994383;0.132495288549612;-0.0620945792349737;0.0583297090784781;0.721421097556756;1.04782971895517;0.958047939048044]
Par=[1170.84706992246;723.989588910496;2.62336937470163e-05;1.17150080479831e-06;2.52309592961230e-06;1.08163834140627e-05;0.130331640281413;-0.121762850460752;1.02845384727616;0.934163981088290;-0.00390424693318188;0.0356972795122610;-0.000562144674765729;0.0669101684782309;0.912783792442412;1.00840735618106;1.45122593209455;1.01943913650204;0.00619166457178692;0.136612083056783;-0.0610233669826268;0.0585155807836084;0.723905542625172;1.04301118429184;0.959950550789836]
Par=[720.248514780929;1084.61469331651;2.70038041252448e-05;1.17270421240858e-06;3.30956624709274e-06;9.53389568240562e-06;0.156171768664682;-0.100048335644059;1.03053180781972;1.01441899436660;-0.00206439111310477;0.0362123076849437;-0.00262559977913180;0.0720315545204439;0.860426688576237;0.950645526110002;1.45687310276266;0.983836946692649;-0.00905739978550043;0.0488057678982562;-0.0114906100532478;0.0890771325112634;0.752842309276481;1.04741691193873;0.906889425502942]
Par=[747.081284539332;1248.48239409355;2.74456722632691e-05;1.38417683318054e-06;3.24577868324654e-06;9.60066066671497e-06;0.141405965421322;-0.102298851090659;1.03288235376804;1.02825624221546;-0.00500919920214009;0.0332235941037383;0.000608443736744711;0.0681001141355022;0.862394216199699;0.967711755905481;1.44956094651586;0.997541693396145;0.00285855494383928;0.0455715816328645;-0.00960084154569893;-0.0151650956421573;0.721666972091724;1.04534195931907;0.911238964711359]

Par=[1170.46440956406;1227.08742622071;3.13539471828037e-05;5.85345162140095e-07;1.62362719925257e-06;1.06466839177537e-05;0.179725915699441;-0.0993600492767416;1.03456512349494;1.07325494070550;0.00945137520267050;0.0413229692017051;0.00138460304552887;0.0847043971487948;0.869196885998942;0.975984475333189;1.47466867791637;1.01353032915626;0.0104447990637047;0.0547264496677699;-0.00771794883967383;-0.00350808476490429;0.735024720285266;1.03926850165751;0.905489699633868]
Par=[1170.01933931929;1247.92831722367;3.24316021421936e-05;5.98546435289279e-07;1.90970960232706e-06;1.05677928390289e-05;0.185499166827890;-0.0993527205790893;1.03771502144993;1.07811563783060;0.0118168289281383;0.0445273271821372;0.00320243736298143;0.0902289382129657;0.870259967754933;0.976734609158333;1.46446825797595;1.00818496329798;0.00698864607592705;0.0584874862134200;-0.00554768323428648;-0.00956155187478256;0.725863838616748;1.03834623321645;0.899207364025682]
Par=[1370.96290652586;1256.08545730133;3.26740661958757e-05;6.12713717877494e-07;1.85165801465788e-06;1.06311690889962e-05;0.184520954952357;-0.0981320169896960;1.03973070538222;1.07850853946919;0.0131008747255250;0.0447367528831150;0.00424180005916861;0.0891639408482471;0.870665707037813;0.977580780367567;1.46248413926954;1.00904742810432;0.00749803625204066;0.0598881111215286;-0.00690405705254394;-0.0151564844418095;0.729512412075329;1.03737230840612;0.898921679502999]
Par=[1495.84384963633;1396.64679459706;3.71895767363188e-05;4.03257437926043e-07;1.76848805296101e-06;1.12075455690842e-05;0.232926452361440;-0.0911038407875883;1.04931546799953;1.08103384482525;-0.0187654606214822;0.0520781951837227;0.00310208860778559;0.0808128406755252;0.887815235019015;1.00921957953785;1.47813690801105;1.01589554520605;-0.0242048520275065;0.110868987829502;0.00919671544572416;0.00607039574484358;0.769618005620278;1.03424549045939;0.924645368333877]
Par=[3497.88354068361;1390.68668449299;4.05484723742329e-05;3.81548267233953e-07;1.79909201511809e-06;1.02718542845171e-05;0.253371796084562;-0.0842595089018010;1.06546524060460;1.10125099913211;-0.0411629117002700;0.0438604704511958;-0.00148177548184482;0.0961038551846292;0.888138842715307;1.00115896058780;1.47873656264697;1.03113692729805;-0.0351494140956321;0.108444761925769;-0.00145026449627895;-0.00361514040897821;0.795445325756116;1.02549603554164;0.918041389740316]
Par=[4313.03813822071;1392.52122547992;3.98463985096168e-05;3.65322753351243e-07;1.96277458028906e-06;9.81655700036246e-06;0.243104700228158;-0.0836732828503633;1.06450453357237;1.10204193471500;-0.0412002265302795;0.0438122061733539;-0.00120224718859353;0.0943003108142435;0.888912472768470;1.01224033882544;1.48569157362679;1.02999123420711;-0.0342917075442173;0.107413437226287;-0.00138425531579626;-0.00395238093408888;0.781777402145370;1.02535272300253;0.915997891364233]
Par=[4528.02223296357;1378.04261448105;3.88614198048511e-05;3.82169403365504e-07;1.85790612290274e-06;9.70295073820092e-06;0.242420857016090;-0.0844211923763379;1.06569936588943;1.10317268844952;-0.0308573313279559;0.0408058312711923;-0.00127611009056678;0.0931951316564918;0.888783767709185;1.00824795759337;1.48943251182855;1.02954755605447;-0.0393402634396605;0.108566328091060;-0.00199205052816865;-0.00217268881090023;0.775950299073608;1.02532950035877;0.915983031014084]

Par=[5262.23223204313;1387.79168035922;3.32838976922647e-05;4.14399376114126e-07;2.65126870219412e-06;9.17036854869862e-06;0.219723307926274;-0.0860504425007320;1.05935068466214;1.12546425042161;-0.0210837666195042;0.0371873415185454;-0.00115692490618156;0.0830869234501761;0.894991401133669;0.993178464586065;1.47834158681200;1.00895017986667;-0.0385802428739252;0.100147190521463;-0.00209364138821117;-0.00225670034182323;0.752383869802578;1.02541293085932;0.894479987335610]
Par=[5241.96208129055;1472.69242987089;3.32587958918414e-05;5.51800953398369e-07;2.39415567360416e-06;9.07391821244994e-06;0.225651439809991;-0.0945161899122833;1.06355208356227;1.11159083004041;-0.0361888185125844;0.0392695019946741;-0.00482374949768358;0.0936021072079221;0.896705319130567;0.963108743490190;1.48802638141514;1.02860557196749;-0.0479572625675467;0.102690970943108;0.00221313332828499;0.00231976598269739;0.766880941969693;0.995104368855206;0.897754439810556]
Par=.99*[5236.21279313464;1958.22657409747;3.77239328790294e-05;1.18710988305151e-06;2.84682837933938e-06;7.64743683452987e-06;0.299855694750302;-0.124981616799684;1.08705203333523;1.05181321841481;-0.0811768531788931;0.0316755610872173;-0.0108950993342708;0.106699758728354;0.858736174376244;0.949318963796749;1.37882668698598;1.04103723632903;-0.0939502181964068;0.0936924430290783;-0.00152468976533865;-0.00325437619004628;0.925900379662770;0.986600099864364;0.890779778251785]
Par=[5262.63213298558;1905.27600623452;3.87129467727867e-05;1.12897002938164e-06;2.84201386444030e-06;7.63839303726262e-06;0.294882750207858;-0.120194144602805;1.10078628991311;1.03616821496567;-0.0727964517610436;0.0304889243744570;-0.0104920289634651;0.107244288531773;0.851572819968040;0.983766586442025;1.47219758484483;1.02125382798928;-0.0867984774934137;0.103701606133737;-0.00148341692117251;-0.00379946119091557;0.820217584500394;1.02282359471107;0.896951200157497]
Par=.95*[5262.80591945963;1918.88354775937;3.87694649738758e-05;1.10903794653789e-06;2.78000710018594e-06;7.68077652894147e-06;0.295893748969390;-0.120647926602158;1.10047696232334;1.03690258848438;-0.0726947302384628;0.0304017773279788;-0.00981557469818173;0.107397812674443;0.851090826121533;0.984802926546279;1.47263183691535;1.02183019081519;-0.0872576079648480;0.102541781913780;-0.00156381229049505;-0.00483593433718131;0.821153961882538;1.02298950925450;0.897806908814807]

Par=[5200;1248.48239409355;2.74456722632691e-05;1.38417683318054e-06;3.24577868324654e-06;9.60066066671497e-06;0.141405965421322;-0.102298851090659;1.03288235376804;1.02825624221546;-0.00500919920214009;0.0332235941037383;0.000608443736744711;0.0681001141355022;0.862394216199699;0.967711755905481;1.44956094651586;0.997541693396145;0.00285855494383928;0.0455715816328645;-0.00960084154569893;-0.0151650956421573;0.721666972091724;1.04534195931907;0.911238964711359]
Par=[9007.23359981296;1336.35571441640;2.88344381217040e-05;1.24053226845759e-06;3.46302955003796e-06;9.66271709832975e-06;0.136850155871276;-0.0992127618814911;1.03087157015001;1.03711842109098;-0.00434680473240891;0.0321544987628009;0.000498560039087611;0.0687686658126528;0.865733391268788;0.966624381812158;1.43781896424416;0.993175573701219;0.00716298429432381;0.0477131946868767;-0.00355406679623663;-0.0142295486433458;0.727594511477857;1.04588017212796;0.907270625800320]
Par=[8987.28046521947;1095.95778631496;2.18368864098869e-05;9.18611175795188e-07;3.09618177856194e-06;8.66457120321515e-06;0.112365689631251;-0.0885227753772454;1.02974454112009;1.04186737929705;-0.00593765898048684;0.0204687548850755;0.000611441888952130;0.0616171711631124;0.884174884741497;0.975704551955574;1.45744161747412;0.989086072401429;0.00834881142476796;0.0477392909338356;-0.00483275491563429;-0.0167192476068255;0.694753263732485;1.04794333368131;0.899598234699297]
Par=[8212.27501849867;1214.50646958831;2.36668093402470e-05;9.81530637818994e-07;7.69613065470293e-06;1.09167525921839e-05;0.123313991889536;-0.0931637881209089;1.03443690279132;1.06404980458423;-0.00699540726249896;0.0270498033870567;-0.000242991243482286;0.0750632211128855;0.894601433996172;0.916578181519442;1.37605571089666;0.961607435389605;0.0166003347994343;0.0576267488802903;-0.00216717910176562;0.0384033063011802;0.695085469580200;1.04808153765475;0.888957760070870]
Par=[18198.02256249369;1262.80708019078;2.37295625239539e-05;8.79776198316199e-07;9.38189387546551e-06;1.21503798315177e-05;0.141967906729970;-0.0956974029161532;1.04245163064691;1.04475816839300;-0.0184786706407538;0.0270989355309503;-5.50185794801516e-05;0.0709291719236122;0.879517766766578;0.903234768543781;1.37518070816724;0.973307081018339;0.00178387159509288;0.0659782377942887;0.00849917879510224;0.0947773328835414;0.682123615599944;1.04077993054339;0.908244781361890]
% Par=[8196.75769239417;1257.88895512615;2.18002173555118e-05;1.20663016323037e-06;1.35370013379675e-05;1.29385713826321e-05;0.160644613465026;-0.112678453620598;1.05735835471980;1.02173839537772;-0.116603225658048;0.0460553063329852;0.000403716195658833;0.0529798492901865;0.841548309352540;0.945135009171368;1.53148314617784;0.961668579597392;0.0335019069577717;0.0790007867073764;0.0128110143971929;0.0369710835127232;0.592556914162650;1.05588013196035;0.890860131868672]
Par=[15779.6021654554;1258.63455994288;2.99457881998995e-05;9.64793738736947e-07;1.27943414634376e-05;1.30305445941787e-05;0.148764966279689;-0.0760306280118538;1.05752960574217;0.998422568360432;-0.0451567057605107;0.0197788967452211;-5.95343078651400e-05;0.0686067841749312;0.879588839915612;0.951248533326095;1.38734383604745;0.979473336128129;0.00122504077183851;0.0771357693694838;-0.00531874260550812;0.108658176112641;0.680218203134416;1.04912236085757;0.914577281523586]
Par=[15779.6021654554;1258.63455994288;2.99457881998995e-05;9.64793738736947e-07;1.27943414634376e-05;1.30305445941787e-05;0.148764966279689;-0.0760306280118538;1.05752960574217;0.998422568360432;-0.0451567057605107;0.0197788967452211;-5.95343078651400e-05;0.0686067841749312;0.879588839915612;0.951248533326095;1.38734383604745;0.979473336128129;0.00122504077183851;0.0771357693694838;-0.00531874260550812;0.108658176112641;0.680218203134416;1.04912236085757;0.914577281523586]
Par=[15774.0496680878;1349.04915317100;2.97631289606277e-05;1.21120970204605e-06;1.10901543219132e-05;1.24050441890679e-05;0.142147454492944;-0.0828048514236694;1.05238712846152;0.970985983033102;-0.0188317967729441;0.00950663421503445;-0.000238769788173954;0.0724314197925322;0.887342448457897;0.956224618200741;1.37314701515750;0.980287570068408;-0.00115150892253818;0.0859638616531325;0.00701562674450779;0.118048625512239;0.689371986449485;1.05581890963466;0.910189705091068]
Par=[15773.0742562019;1496.90985421812;2.92403288407731e-05;1.12498847696170e-06;8.50733453034942e-06;1.20935791682673e-05;0.142396931675208;-0.0980975755565307;1.05105862372533;0.958571760554306;-0.0157119449651198;0.00152027380996454;0.000561582117730856;0.0744126277623032;0.887894249208918;0.970103960081882;1.38180013764068;0.984768221585570;-0.00281999539241436;0.0887778540026647;0.00891094074956398;0.132374341724343;0.714619314718906;1.05998298780716;0.905409388953708]

%regular Optim

Par=[3103.16256846100 0 0 0
    3.16242649221822e-05 1 1 0
    1.34894947218148e-06 1 1 0
    9.61318512727303e-06 0 1 1
    1.42374154198437e-05 0 1 1
    0.0576167891146790 0 0 1]
Par=[Par(:)];

Par=[1496.90985421812;2.92403288407731e-05;1.12498847696170e-06;8.50733453034942e-06;1.20935791682673e-05;0.142396931675208;-0.0980975755565307;1.05105862372533;0.958571760554306;-0.0157119449651198;0.00152027380996454;0.000561582117730856;0.0744126277623032;0.887894249208918;0.970103960081882;1.38180013764068;0.984768221585570;-0.00281999539241436;0.0887778540026647;0.00891094074956398;0.132374341724343;0.714619314718906;1.05998298780716;0.905409388953708]
%optim
Par=[1980.72752909081;1.64690502015513e-05;2.57490322576654e-06;1.33941702480044e-05;1.98797492565391e-05;0.138854975048034;-0.193207252386133;1.05332458720592;0.854351954484050;0.0158511247142765;0.00256581387701913;0.000149034227921214;0.0152584871181608;0.896812915131756;1.02484908661401;1.36742179454387;1.00910437363604;-0.00361605047189680;0.163647298067754;-0.0109424879418248;0.0382318718350450;0.561227768801514;0.977929946401335;0.926677697905429]
Par=[1517.58709385903;2.17704998248171e-05;1.68221014263901e-06;1.20606897401799e-05;2.11451147026475e-05;0.175845004900460;-0.208861488355681;1.03084055033943;0.829858741692364;-0.0197721600839576;0.00977487428832263;-0.000443501700730862;0.0231859807644116;0.947549323195331;1.09221311233580;1.41859807953960;1.00567157926402;0.000653271809018550;0.158168980786631;-0.125133155367498;0.0661389779732248;0.582095314757572;0.971138219780992;0.895581297873695]
Par=[1682.78550719605;2.63203883262437e-05;2.17282975087299e-06;1.60902769030275e-05;2.17193669758558e-05;0.172596862363366;-0.219841581568237;1.02850285191458;0.803248236292166;-0.0476093759874937;0.0197969178273852;0.000394657515617972;0.0416125830769352;0.937863050998602;1.09847975236818;1.40676874379916;0.972732875415408;-0.00138981540135734;0.143721186060700;-0.131849817690720;0.0666722620041408;0.601070930477134;0.989021043156200;0.897227947013266]
Par1=[2033.02375487047;3.16130089470747e-05;1.90340632780007e-06;1.30204753764812e-05;2.46673465121515e-05;0.174046212067529;-0.221811643870088;1.02565799932984;0.770609312800604;-0.0568698282579756;0.0309276246875715;0.00257076918300381;0.0528351110215727;0.927032219623544;1.12195867606654;1.41892303834842;0.947158349455085;-0.00872097323610016;0.112660622747669;-0.137037623391209;0.110334184354555;0.635587028555224;0.987069742346058;0.903724269057161]
Par2=[1893.85399179173;3.35180349503643e-05;1.80154872857620e-06;1.57321454337009e-05;2.26008754155557e-05;0.197242717622704;-0.214580013710896;1.02693567942322;0.732538419977937;-0.0806659814545019;0.0372324831616921;0.00405747083171369;0.0514826099725239;0.919010979337435;1.17091671480283;1.43679657476347;0.948503414050512;-0.0118136204009586;0.114416440017665;-0.136414459336656;0.126530520894845;0.635463551969217;0.985241573193049;0.883792043126100]
Par=(Par1+Par2)/2
Par=[1980.71265449285;3.62252001072929e-05;1.52314804032773e-06;1.57510167737796e-05;2.09308821818926e-05;0.186972316502345;-0.212539507306393;1.02694404469759;0.735802605569922;-0.0845979085000798;0.0480085909188035;0.00179329538679024;0.0664394151639856;0.933182276107138;1.19201960351960;1.43059277587154;0.943798810216922;-0.0219997863023313;0.0932458695710852;-0.158204526566466;0.118776537292288;0.644078680887051;0.983793978374706;0.903254882197126]
Par=[2048.20361394374;3.70224772741702e-05;1.52910406900657e-06;1.63958858966707e-05;1.94280884445984e-05;0.190330088415770;-0.214888278036188;1.03392935146525;0.734925575629839;-0.0838951136561574;0.0495735789817976;-0.00268437974784675;0.0818834457624922;0.930864772504319;1.20062415761033;1.43047306288266;0.950504747944062;-0.0158001799630194;0.0829846319573252;-0.160297776336397;0.111527797826434;0.639541401660424;0.980843843451573;0.897177777789631]
Par=[2109.75433153742;3.98593271627716e-05;1.43917218583152e-06;2.05045070110400e-05;1.89398031300465e-05;0.231583699346444;-0.223070191605324;1.03521288310129;0.728818976211521;-0.114739006284452;0.0485478407612115;-0.0187343727193816;0.0890454085579686;0.923412798434685;1.21700476223042;1.43775628763740;0.952206277395896;-0.0243704971197575;0.0782098193510595;-0.167956792452982;0.109730894290289;0.643116078517813;0.983982739978923;0.902836576278474]
Par2=[1622.43150194471;4.24288413038541e-05;1.43410019344406e-06;2.49847326492470e-05;2.02906773644435e-05;0.265589166079366;-0.216213798798592;1.03124478597532;0.709044418824586;-0.122438170685767;0.0457024614259633;-0.0252722007018254;0.109596927788774;0.922987217525209;1.26371062666460;1.44566017036424;0.931207821390055;-0.0447992341755130;0.0903468801471983;-0.160829439389279;0.0919886103946868;0.625490773794079;0.994047557945036;0.907580537980492]
Par1=[1905.31512384662;4.82655695999841e-05;1.64035896997307e-06;3.04330226898342e-05;1.99356266977747e-05;0.245921345813528;-0.266848308160465;1.02406091705608;0.613881405422500;-0.148689249990631;0.0361865071995570;-0.0369676279905232;0.147922799765481;0.921374729976296;1.33484456419619;1.47385293098938;0.926102817181253;-0.00885539161577154;0.0999256015223333;-0.161909052354064;0.155761553474509;0.637512409239939;1.01337747349572;0.891962023390813]
Par=(Par1+Par2*2)/3
Par=[1874.25733463379;4.24417027680706e-05;1.56698676325925e-06;2.57623489384054e-05;2.02865911658039e-05;0.262832261918540;-0.240564383099620;1.03475365042909;0.660024028539574;-0.133614150485364;0.0415073490491217;-0.0274334048572902;0.120229241585969;0.921692972506647;1.29627359539937;1.46353920170610;0.927421845479556;-0.0393317213465272;0.0919223146993001;-0.164718799638751;0.124710105020431;0.632043939021851;1.00191842738274;0.903874312357813]
Par=[2041.47268252353;5.00396479173130e-05;1.58271706006361e-06;2.89933858118167e-05;2.01974664064434e-05;0.294006511024592;-0.243605436640806;1.03399329930110;0.656475505289393;-0.153503134191659;0.0397709188045785;-0.0293737138451394;0.126726352542406;0.912919840877928;1.30595144065291;1.47935348102370;0.930658675595974;-0.0395399531877818;0.0748025259974428;-0.178759987291515;0.118259892028700;0.626936103552563;1.00043598523427;0.890719469533799]




% close all
lst_ODE_model(Par,1)
drawnow; pause(2)

% options = optimset('Display','iter','MaxFunEvals',3000,'MaxIter',3000);
% new_par=fminsearch(@lst_ODE_model,Par,options,0)
% lst_ODE_model(new_par,1)
% 
% zp=reshape(new_par(1:end),[6 4]);
% double(int16(zp(:,2:4)*1000))/1000

Pa=reshape(Par(1:end),[6 4]);

return

function z=lst_ODE_model(Par,g)

Par(1:6)=abs(Par(1:6));


ok=0;lst1=0;lst2=0;lstl1=0;
% Par([11 12 ])=0;

load('Dados01')

    
Tspan=50:1000;
options = odeset('RelTol',1e-6,'AbsTol',1e-6);     
[t,y] = ode45(@ODE_SWG2,Tspan,[Ya(Tspan(1),:)],options,Par);
if t(end)<Tspan(end)
    ok=1e12
end
Yss=y(end,:);
if g==1
    newcolors = [0.25 0.80 0.54;0.7 0.7 0.7;0.83 0.14 0.14];
         
    
    figure(1)
    colororder(newcolors)
    plot(t,y, 'LineWidth', 1.5)
    
    hold on
    plot(Ta,Ya,'--', 'LineWidth', 1.5)
    hold off
    legend('grass','sheep','wolves')
%     y(end,:)
% [y]
end

dadosS=interp1(t,y,Ta);
lst=(dadosS-Ya).^2;
lst(isnan(lst))=0;
lst1=sum(sum(lst));

load('Dados02')


Tspan=1051:2000;
     
[t,y] = ode45(@ODE_SWG2,Tspan,[Ya(Tspan(1),:)],options,Par);

if t(end)<Tspan(end)
    ok=1e12
end

if g==1
    figure(2)
    colororder(newcolors)
    plot(Ta(1000:end),Ya(1000:end,:),'--', 'LineWidth', 1.5)
    hold on
    plot(t,y, 'LineWidth', 1.5)
    hold off
    legend('grass','sheep','wolves')
    xlim([1000 2000])
%     y(end,:)
% [t,y]


end
dadosS=interp1(t,y,Ta);
lst=(dadosS-Ya).^2;
lst(isnan(lst))=0;
lst2=sum(sum(lst));


load('Dados03')
load('Dados03s')
Tspan=1000:2000;
     
[t,y] = ode45(@ODE_SWG2_wC,Tspan,Yss,options,Par);
if t(end)<Tspan(end)
    ok=1e12
end

if g==1

    figure(3)
    colororder(newcolors)
    plot(t,y, 'LineWidth', 1.5)
    hold on
    plot(Ta(1000:2000),Ya(1000:2000,:),'--', 'LineWidth', 1.5)
    plot(Ta(1000:2000),Ya(1000:2000,:)+3*Yas(1000:2000,:),'--', 'LineWidth', 1)
    plot(Ta(1000:2000),Ya(1000:2000,:)-3*Yas(1000:2000,:),'--', 'LineWidth', 1)
    
    hold off
    legend('grass','sheep','wolves')
    xlim([1000 2000])
%     y
end

dadosS=interp1(t,y,Ta);
lst=(dadosS-Ya).^2;
lst(isnan(lst))=0;
lst3=sum(sum(lst));




if g==1 disp([lst1 lst2 lst3]);end

z=lst1+lst2+lst3*0+ok;
end
% function dxdt=ODE_SWG(t,x,p) %This is the ODE function
% 
% K=255*255;
% 
% 
% Pn=reshape(1:24,[6 4]);
% Pr(:,1)=p(Pn(:,1));
% Pr(:,2:4)=repmat([x(1) x(2) x(3)],6,1).^p(Pn(:,2:4));
% Pr=prod(Pr,2);
% 
% dxdt=[Pr(1)-Pr(2)
%       Pr(3)-Pr(4)
%       Pr(5)-Pr(6)];
% 
% end
function dxdt=ODE_SWG2(t,x,p) %This is the ODE function
K=255*255;

Pa=reshape(p,[6 4]);
Pr=nan(6,4);
Pr(:,1)=Pa(:,1);
Pr(:,2)=x(1).^Pa(:,2);
Pr(:,3)=x(2).^Pa(:,3);
Pr(:,4)=x(3).^Pa(:,4);

Pr=prod(Pr,2);

dxdt=[Pr(1)-Pr(2)
      Pr(3)-Pr(4)
      Pr(5)-Pr(6)];

end
function dxdt=ODE_SWG2_wC(t,x,p) %This is the ODE function
K=255*255;

u=0;
if t>1500 u=.01; end

Pa=reshape(p,[6 4]);
Pr=nan(6,4);
Pr(:,1)=Pa(:,1);
Pr(:,2)=x(1).^Pa(:,2);
Pr(:,3)=x(2).^Pa(:,3);
Pr(:,4)=x(3).^Pa(:,4);

Pr=prod(Pr,2);

dxdt=[Pr(1)-Pr(2)
      Pr(3)-Pr(4)
      Pr(5)-Pr(6)-u*x(3)];

end
