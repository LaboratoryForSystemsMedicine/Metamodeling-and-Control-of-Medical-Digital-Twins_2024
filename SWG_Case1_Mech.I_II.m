Par=[.1
    0.00001
    0.001
    0.001
    0.00001
    0
    0
    0
    0]

Par=rand(7,1)*.000001;
Par=[0.118763480517372;1.22574003209124e-05;1.17478158157631e-05;6.30211152471185e-06;-1.09187798224161e-08;2.03192662547802e-05;4.39963162283663e-06;0.0173909754543080]
Par=[0.209932042470109;5.73281095848473e-06;1.78275825920669e-05;1.64797106508997e-06;1.67237356839898e-08;2.35615344622281e-05;6.08887382459372e-06;0.0242500331207036]
Par=[0.226446708310787;5.93906844127652e-06;2.06432250009854e-05;1.53236588314138e-06;8.17282690496993e-08;2.17778325494505e-05;6.86802929569710e-06;0.0274435814275248]
Par=[0.229195247760752;6.00417534657606e-06;2.09346108036191e-05;1.52585339121064e-06;0*8.13963764632397e-08;2.16733013363738e-05;6.91557598108693e-06;0.0276372309873188]
Par=[0.257272457801063;6.80163652790021e-06;2.29967215612982e-05;1.86587478173381e-06;0.0129519941414342;1.69697220237869e-05;7.95504254634186e-06;0.0319507353007421]
Par=[0.369553921581830;1.02557516149795e-05;3.06766669595089e-05;2.09837299083317e-06;0.1*0.0208532037317784;1.58775019605871e-05;9.39691249237440e-06;0.0371120878188523]
Par=[0.297196323600532;7.79270037528373e-06;2.70519941543666e-05;1.84981232093844e-06;0.0186305522204251;1.38159525791854e-05;1.06653663887634e-05;0.0426791046594563]

%II
Par=[0.0706541146878834;1.36754101183485e-06;8.96474438852540e-06;1.18036673065974e-06;0.00670129414510672;2.51900249982729e-05;8.31148059146504e-06;0.0349369702318089]
Par=[0.0847471387475558;1.52739431735527e-06;1.20983486843131e-05;9.12956263921536e-07;5.86320769426762e-17;2.24867368438913e-05;9.24221896622044e-06;0.0366275775692507*.5]

Par=[0.175803486543415;4.87679371956660e-06;1.39305742488374e-05;1.11451792535375e-06;-7.29946443411139e-15;1.50674315039895e-05;1.69464254695352e-05;0.0697145126297619]
Par=[0.132388781926184;4.09358900944949e-06;8.18549662188496e-06;2.28313082880595e-06;1.20856172484458e-14;4.00858902952011e-05;6.01285100027427e-06;0.0242259585748660]
Par=[2.99867666058301;8.79909647912574e-05;0.000212237114050151;2.75543621952848e-06;8.94733461221763e-12;4.61819334311796e-05;5.70413629849414e-06;0.0231815940398915]
Par=[2.97097048451995;8.76874021004943e-05;0.000210556737097566;2.77875265431698e-06;9.54156108085978e-12;4.67126146306222e-05;5.65787444501755e-06;0.0226864202046702]
Par=[2.24076394134574;5.44189997198721e-05;0.000222885283192681;1.34042623207682e-06;4.93685365220588e-11;2.13969762831520e-05;8.83560838449330e-06;0.0364918155515539]
Par=[2.24076446198027;5.44189655979502e-05;0.000222885830957224;1.34042867955421e-06;5.18428701413529e-11;2.13969149450485e-05;8.83561285003476e-06;0.0364918420291210]
Par=[0.781970481333408;1.49174958230283e-05;0.000101217985541271;1.08846331002079e-06;-1.17319603863025e-10;1.43054443513546e-05;1.14785796192741e-05;0.0476704482616278]
Par=[0.779585130049299;1.49049941380853e-05;0.000100183495949756;1.10047454330275e-06;2.92865076961388e-10;1.44906508820046e-05;1.13842882548302e-05;0.0475413673287148]
Par=[0.865003536754349;1.85993479024213e-05;9.99863593274397e-05;1.53364682210998e-06;1.22696415691133e-10;2.40698241768720e-05;9.07926831581466e-06;0.0376789968493580]
Par=[0.919959579582742;1.76129924350270e-05;0.000118014073463110;1.10552736850642e-06;1.40310239460460e-10;1.46718814051780e-05;1.13903669449068e-05;0.0475897429807602]
Par=[0.779585130049299;1.49049941380853e-05;0.000100183495949756;1.10047454330275e-06;2.92865076961388e-10;1.44906508820046e-05;1.13842882548302e-05;0.0475413673287148]

Par=[0.779577024978499;1.49048003086064e-05;0.000100183022436621;1.10046943167627e-06;6.51457870401159e-09;1.44909758183489e-05;1.13843353132971e-05;0.0475414186727448]
Par=[0.779545406017759;1.49055603844916e-05;0.000100164507179744;1.10076792458209e-06;8.32312810657432e-09;1.44991866922126e-05;1.13834341962562e-05;0.0475406531609649]
Par=[0.779424431723426;1.49147065353610e-05;0.000100087699294999;1.10144995521729e-06;7.83085289712754e-09;1.45633449114296e-05;1.14197474561476e-05;0.0476887490853695]
Par=[0.786165392899947;1.51416745504470e-05;0.000100300630930564;1.11036351837843e-06;-3.55828951860869e-10;1.51256727438656e-05;1.16462583254463e-05;0.0486659152552750;1]

Par=[0.828205310915043;1.63601357282600e-05;0.000101971100938919;1.15287209404435e-06;1.84600099487236e-10;1.71448775801173e-05;1.49694113639191e-05;0.0514966636473906;0.975295218002664;1]
Par=[0.730806718294911;1.40862751996793e-05;9.38075399757469e-05;2.17233389115407e-07;0*8.46694168384902e-10;1.49940515165740e-05;1.58656751752167e-05;0.0533592642593144;0.974871060007082;1.15164949679257]
Par=[0.279982735287307;5.22044105576506e-06;3.65471057842151e-05;1.28888077589209e-06;-0.0103494127193070;8.65427802378210e-06;1.58541720647316e-05;0.0741406177367402;1.01319083705936;0.982689708793225]
Par=[0.279390362006796;5.21194472086712e-06;3.64711977465624e-05;1.30690693061681e-06;-0.0104180449512715;8.61941373678007e-06;1.58754674254632e-05;0.0741934113337693;1.01316325015823;0.981439929646681]
Par=[0.279765229005461;5.20856473896314e-06;3.66081112710788e-05;1.34726868901087e-06;-0.0104710952351056;8.61339665274459e-06;1.60355258680206e-05;0.0743604738759279;1.01231951456715;0.978586716623841]
Par=[0.279765229005461;5.20856473896314e-06;3.66081112710788e-05;1.34726868901087e-06;-0.0104710952351056;8.61339665274459e-06;1.60355258680206e-05;0.0743604738759279;1;1]
Par=[0.281024949535631;5.24783642584521e-06;3.66677484330458e-05;1.48888020223542e-06;-0.0105443206381853;8.72900119087192e-06;1.44018261245746e-05;0.0729787453828683;1.02289893903244;0.969755489188928]

Par=[0.285487680449469;5.33242443520737e-06;3.72375262714796e-05;1.06307408250693e-06;-0.00976641441404642;8.74426284165664e-06;1.77474578208685e-05;0.0742973447534919]
Par=[0.285487132112312;5.33238461415565e-06;3.72376072055770e-05;1.06307548922652e-06;0.000976695905904066;8.74392537383987e-06;1.77476886036603e-05;0.0742982169151981]
Par=[0.274795494948602;5.35117395710736e-06;3.45803658006707e-05;1.07727746665377e-06;0.00151816358328941;1.41660475677399e-05;1.28156105497254e-05;0.0537284480913718]
Par=[0.312353796418932;5.85557605717184e-06;4.05520886225693e-05;1.06480470368471e-06;0.00929222608790063;9.09481387901246e-06;1.73191937359580e-05;0.0726193275176364]
Par=[0.312310555494158;5.85439422621386e-06;4.05492968466351e-05;1.06454870409512e-06;0.00929093462793863;9.08753695880071e-06;1.73197850179870e-05;0.0726185381289853]
Par=[0.302276349872314;5.65600591409539e-06;3.93427398949775e-05;1.06295216808567e-06;0.00953891745517237;8.90092805768248e-06;1.75837503063374e-05;0.0736587599152047]

Par=[0.271534422167105;5.06439269612949e-06;3.54767246927118e-05;1.06349863925472e-06;0.0100168833738356;8.57919266464095e-06;1.79504478308065e-05;0.0751134696364733]

% close all
lst_ODE_model(Par,1)
drawnow; pause(.1)

% options = optimset('Display','iter','MaxFunEvals',3000,'MaxIter',3000);
% new_par=fminsearch(@lst_ODE_model,Par,options,0)
% lst_ODE_model(new_par,1)
% z=new_par;
% old=4.3531e+08

return

function z=lst_ODE_model(Par,g)
Par=abs(Par);
ok=0;lst1=0;lst2=0;

load('Dados01')
Tspan=50:1000;
options = odeset('RelTol',1e-6,'AbsTol',1e-6);     
[t,y] = ode45(@ODE_SWG,Tspan,[Ya(Tspan(1),:)],options,Par);
if t(end)<Tspan(end)
    ok=1e12
end

if g==1
    newcolors = [0.25 0.80 0.54;0.7 0.7 0.7;0.83 0.14 0.14];
         
    
    figure(1)
    colororder(newcolors)
    plot(t,y, 'LineWidth', 1.5)
    
    hold on
    plot(Ta,Ya,'--', 'LineWidth', 1.5)
    hold off
    legend('grass','sheep','wolves')
       
%     y(end,:)
end
dadosS=interp1(t,y,Ta);
lst=(dadosS-Ya).^2;
lst(isnan(lst))=0;
lst1=sum(sum(lst));

load('Dados02')
Tspan=1051:2000;
     
[t,y] = ode45(@ODE_SWG,Tspan,[Ya(Tspan(1),:)],options,Par);
if t(end)<Tspan(end)
    ok=1e12
end

if g==1
    figure(2)
    colororder(newcolors)
    plot(Ta(1000:end),Ya(1000:end,:),'--', 'LineWidth', 1.5)
    hold on
    plot(t,y, 'LineWidth', 1.5)
    hold off
    legend('grass','sheep','wolves')
    xlim([1000 2000])
    
%     y(end,:)
end
dadosS=interp1(t,y,Ta);
lst=(dadosS-Ya).^2;
lst(isnan(lst))=0;
lst2=sum(sum(lst));

if g==1
load('Dados03')
load('Dados03s')
Tspan=1000:2000;
     
[t,y] = ode45(@ODE_SWG_wC,Tspan,[2.4301 0.4189 0.1831]*1e4,options,Par);
if t(end)<Tspan(end)
    ok=1e12
end


    figure(3)
    colororder(newcolors)
    plot(t,y, 'LineWidth', 1.5)
    hold on
    plot(Ta(1000:2000),Ya(1000:2000,:),'--', 'LineWidth', 1.5)
    plot(Ta(1000:2000),Ya(1000:2000,:)+3*Yas(1000:2000,:),'--', 'LineWidth', 1)
    plot(Ta(1000:2000),Ya(1000:2000,:)-3*Yas(1000:2000,:),'--', 'LineWidth', 1)
    
    hold off
    legend('grass','sheep','wolves')
    xlim([1000 2000])
   
%     y(end,:)

dadosS=interp1(t,y,Ta);
lst=(dadosS-Ya).^2;
lst(isnan(lst))=0;
lst3=sum(sum(lst));
end


z=lst1*1e0+lst2+ok;
end
function dxdt=ODE_SWG(t,x,p) %This is the ODE function

K=255*255;

% ds=p(4)*x(2)-p(5)*x(1)*x(2);
% ds=ds*(ds>=0);
% dw=p(8)*x(3)-p(9)*x(2)*x(3);
% dw=dw*(dw>=0);
% 
% dxdt=[p(1)*(K-x(1))-p(2)*x(1)*x(2)
%       p(3)*x(2)-ds-p(6)*x(2)*x(3)
%       p(7)*x(3)-dw];
  
dxdt=[p(1)*x(1)-p(2)*x(1)^2-p(3)*x(1)*x(2)
      p(4)*x(1)*x(2)-p(5)*x(2)-p(6)*x(2)*x(3)
      p(7)*x(2)*x(3)-p(8)*x(3)];

end
function dxdt=ODE_SWG_wC(t,x,p) %This is the ODE function

K=255*255;
u=0;
if t>1500 u=.01; end
  
dxdt=[p(1)*x(1)-p(2)*x(1)^2-p(3)*x(1)*x(2)
      p(4)*x(1)*x(2)-p(5)*x(2)-p(6)*x(2)*x(3)
      p(7)*x(2)*x(3)-p(8)*x(3)-u*x(3)];

end