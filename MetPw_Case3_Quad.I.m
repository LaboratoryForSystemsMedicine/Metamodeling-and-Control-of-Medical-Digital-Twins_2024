warning off
%Quad   -0.0000   -0.0000   -0.0000    4.3226    7.6794  1e4
Par=[0     0     0     0     0
     0     -1     0     0     0
     0     0     -2     0     0
     0     0     0     -1     0
     0     0     0     0     -1]/100000;
 Par=[Par(:);zeros(75,1)];
Par=[9e4; Par];
% load('new_par');
% Par=new_par;
% Par(1)=5e4;
Par=[49686.9536089088;1.48358069845512e-11;2.14429175291801e-10;1.21633554496691e-07;6.11221147892996e-08;2.18649293454104e-10;7.71492357865689e-11;-1.00618110862709e-05;2.98870106972534e-11;9.84586971535705e-11;0.000188340851823117;7.55697848732143e-11;1.95100486830213e-10;-2.02697260637161e-05;1.95890558606000e-06;2.35087134449382e-05;3.72257928457561e-05;-2.07921185908148e-11;7.37095251187850e-11;-9.85420842622229e-06;6.19746042905640e-11;2.68939170477780e-07;-1.31293906795807e-11;1.85123639225633e-11;-5.10407295695612e-11;-9.87585641811936e-06;7.09877912527735e-12;-7.10772311088273e-12;-4.41799612000378e-12;-5.41971620522541e-12;-4.89486682728113e-12;-3.76707201619069e-11;-1.51957382053891e-11;-1.45863293184823e-11;-2.14772431625342e-11;-2.07023611582937e-11;-5.38689577794228e-12;3.47546938913413e-11;-1.00976288521608e-11;-4.55111735736869e-12;-1.64047094450558e-11;9.59395522346760e-12;-9.24257369742283e-13;-5.60183624793112e-12;-1.33741036566197e-12;-3.08104058139898e-13;9.76123328114069e-12;-6.62119808001083e-12;-5.64398131600957e-12;-4.74365115212989e-12;1.50058459081202e-12;2.29892262445087e-11;2.04381339537473e-10;4.83872529343062e-07;2.12286309575241e-10;2.14489040057410e-10;-5.71088554115425e-11;-5.94459743062647e-12;-9.93441866566113e-12;3.05448693164397e-08;2.10616910927835e-10;-5.96695447994216e-12;-9.58805983408061e-11;-7.43149032019963e-12;-1.61107260056930e-12;6.46427691907447e-12;1.03593712201169e-11;6.78924417658260e-11;8.49768223259474e-12;4.51117675862884e-12;1.68567585682709e-12;-1.54389280021181e-11;-2.90529640102415e-12;3.80492074429225e-09;1.06362682531044e-11;1.11544874612390e-11;-2.03790907451725e-12;3.54191263980840e-12;6.25984477010228e-11;2.14933857168240e-11;7.14150868850579e-12;-1.18474720297200e-11;-8.10017961067267e-12;5.19227346468955e-11;-2.77735302867692e-11;4.07976694998835e-12;-1.77807142514989e-12;1.40844808761762e-11;6.01044476930224e-12;2.39353588799594e-11;2.55402598821803e-12;-5.13407266713762e-12;4.07197412496623e-12;2.54826274309157e-12;1.57896389024395e-11;1.09467155857655e-11;-4.04249510167358e-12;-1.39076808150799e-12;-5.79767431356080e-13;-2.65467946879760e-12;9.97860818930262e-12]
Par=[44913.5979908048;1.51848749331218e-11;2.13768779676981e-10;1.22175384805007e-07;6.16769002409234e-08;2.26556457671810e-10;8.55908813091265e-11;-1.00778802296070e-05;3.17493294470715e-11;1.06447645542279e-10;0.000193806352233509;7.83141629088210e-11;1.98751880496044e-10;-2.57875960347440e-05;2.05892606626817e-06;2.36836862899856e-05;3.73157122395286e-05;-2.08794930621762e-11;7.42836021323856e-11;-1.00560800804742e-05;6.29134163238319e-11;2.50354287718893e-07;-1.34110427061301e-11;1.80793027851149e-11;-5.13996415203917e-11;-1.03582356934793e-05;6.19049680690752e-12;-8.52607361276011e-12;-4.97116050595138e-12;-4.88289463352042e-12;-4.86121073453319e-12;-4.05873397406841e-11;-1.46809022664927e-11;-1.53897829261243e-11;-2.20301269281669e-11;-2.15622999690810e-11;-5.65131755909791e-12;3.47373742969756e-11;-1.07278556275248e-11;-4.31700354779782e-12;-1.73234958691328e-11;1.03974771452324e-11;-9.40438288968004e-13;-5.71633824312543e-12;-1.37697944432322e-12;-3.23407787097806e-13;1.26187595175390e-11;-6.07231553895944e-12;-5.27352651661005e-12;-5.03277898568656e-12;1.48839331169331e-12;2.47135316193270e-11;2.08246592568920e-10;3.97744879208188e-07;2.19452637491092e-10;2.13961820897343e-10;-5.96445578735583e-11;-6.23185625799554e-12;-1.02908253202146e-11;3.44976098070671e-08;2.16998299144631e-10;-5.89392477203283e-12;-9.73580612386983e-11;-7.38731630815124e-12;-1.62152991836954e-12;6.48942357839035e-12;1.06313543208826e-11;6.92245031472693e-11;8.64844808873574e-12;4.67371205195663e-12;1.76116316822427e-12;-1.63333133579296e-11;-2.89864627371240e-12;3.39609299293338e-09;1.09888514771848e-11;1.16352131769407e-11;-2.04139714102348e-12;3.62820210967629e-12;6.83760150347019e-11;2.05882940121971e-11;7.08076746248494e-12;-1.11902534596287e-11;-8.03851649648667e-12;5.44083998901094e-11;-3.00351412123087e-11;4.08271578805248e-12;-1.88910384169053e-12;1.36851707369444e-11;6.07144784599308e-12;2.54674619371455e-11;2.56374041911435e-12;-5.59327054913312e-12;4.04625388914944e-12;2.55960574518520e-12;1.64313817771737e-11;1.09469342637365e-11;-4.32613324522822e-12;-1.38262032248417e-12;-6.15938972187259e-13;-2.72349405033718e-12;1.06900168196812e-11]
Jac=[9591.99969272528;7.16127312932288e-13;-5.07239882271427e-13;2.51364112194667e-06;3.14756514774089e-10;-5.86569693678049e-11;-6.91154827772400e-11;-2.10264665146083e-05;-1.85632942128507e-11;6.29710074920925e-09;0.000327437312956540;1.91431699350988e-11;-5.32942953483126e-10;-0.000101627235807660;9.73968332307876e-05;2.82809936046273e-05;4.20806619385109e-05;-1.96428276980870e-13;1.83716185964897e-12;-2.09921990314471e-06;3.12346119648201e-13;-9.08302964108138e-07;-1.09242131319110e-14;6.74107788995125e-12;1.93817487471366e-12;-9.68067848611973e-06]
Par(1:26)=Jac;
Par=[9152.37485182433;3.55110973991601e-13;-6.12373505038047e-13;3.22159821264718e-06;3.69640773470843e-10;-6.41136362785246e-11;-8.29481276468246e-11;-1.37576615318915e-05;-1.85290895308768e-11;5.61848506057216e-09;0.000287917123212990;2.36237610526582e-11;-5.60285075722631e-10;-0.000126644363545174;8.26021912244375e-05;2.87472517421292e-05;4.04585539907031e-05;-3.05841034837633e-13;2.06276962358955e-12;-2.39072261986945e-06;5.47098450108160e-13;-9.53435822469777e-07;-1.10137637646079e-14;7.17531634042849e-12;2.54975466867911e-12;-9.43216771729017e-06;4.27138761072082e-12;-8.14274656932705e-12;-5.33529777598035e-12;-4.84570639831931e-12;-5.29134105499539e-12;-4.86699687299787e-11;-1.68513711951384e-11;-1.53070028071180e-11;-2.58661357545657e-11;-2.93823371658589e-11;-3.95408908718480e-12;1.20757278766466e-11;-8.86775202914590e-12;-5.08401699831057e-12;-1.59167966770298e-11;8.40590832743845e-12;-1.22562527378344e-12;-6.66234392111287e-12;-1.50574782582085e-12;-3.95448850137006e-13;1.22379897462152e-11;-6.97780826768054e-12;-6.76913944761155e-12;-6.00386600408007e-12;1.45643460740975e-12;2.90554380039874e-11;2.65859891656505e-10;1.26153235820742e-07;2.03295741738173e-10;2.46849746043611e-10;-6.41471153090895e-11;-5.39507078513002e-12;-6.38543341915691e-12;2.90768275689051e-08;2.26769642468428e-10;-5.94716647321435e-12;-8.16666970100697e-11;-8.85964212904759e-12;-1.72737522261366e-12;7.10150013563675e-12;1.26954205557488e-11;8.89578464533913e-11;1.03443183616513e-11;4.60364454171192e-12;2.37990030498487e-12;-1.42752301646197e-11;-3.44140426706919e-12;2.53435227921842e-09;1.11389339325706e-11;1.12588484849582e-11;-3.21953964923621e-12;3.70042246730081e-12;6.25784650526418e-11;2.12495975505335e-11;6.48850297063790e-12;-1.48973835356739e-11;-3.74646373523816e-12;6.04573361967943e-11;-1.76830416233407e-11;2.41057250046054e-12;-2.28856608729208e-12;1.19511374664098e-11;6.77676550150712e-12;2.72003291957179e-11;2.66716826465616e-12;-6.11040711417879e-12;3.66045351675833e-12;3.06362448027586e-12;1.95521286172848e-11;1.07211647254222e-11;-4.83899129184815e-12;-1.40495551900665e-12;-6.66488306863906e-13;-2.94209201756519e-12;9.90947983159761e-12]
Jac=[.75*5862.78648763619;-2.03920665065897e-13;2.83460145327401e-14;2.22187714852117e-06;-1.91029061776681e-09;1.28696333972707e-11;-4.36837948496940e-10;-3.15393830078985e-05;-7.85642341705263e-15;3.18864232785681e-13;7.21492718260532e-05;-9.50097088320954e-15;-9.99302589425690e-13;-9.58145468767231e-05;9.20819282908811e-05;3.20692018235636e-05;4.12067112512392e-05;-4.15261141450578e-14;5.31968886149829e-13;-2.87295672465680e-06;3.15757981359991e-16;-5.47669275027506e-07;-1.99095193301165e-15;2.14299558927376e-13;-1.56260002213063e-13;-1.08404651494043e-05]
Par=[9228.55659478140;3.69839310681749e-13;-6.27782553408930e-13;3.26786998639562e-06;3.83756965977967e-10;-6.75819063561038e-11;-8.36642644447546e-11;-1.33227866116895e-05;-1.86748498059065e-11;5.56870072679794e-09;0.000287781776641746;2.30274173365678e-11;-5.72457816496075e-10;-0.000126584958627585;8.25561311624913e-05;2.87073856148755e-05;4.03645283981446e-05;-3.05536919783203e-13;2.12911544609895e-12;-2.34754998502462e-06;5.41233486055391e-13;-9.17805950788306e-07;-1.16583759620855e-14;7.27600823054733e-12;2.55368043395504e-12;-9.47735620010477e-06;4.10686706284278e-12;-8.07154146588184e-12;-5.65815863657073e-12;-4.91462375907393e-12;-5.45605824360160e-12;-5.01032772841453e-11;-1.66764944561758e-11;-1.57162367604618e-11;-2.60330054858603e-11;-3.10118854632511e-11;-3.86446115018258e-12;1.09822803618409e-11;-8.91529150918816e-12;-5.19687547625858e-12;-1.56864405818638e-11;8.26897642708314e-12;-1.24623849399652e-12;-6.81331326517977e-12;-1.45431293593407e-12;-4.07931509259580e-13;1.27472265665445e-11;-7.02692631755476e-12;-6.73188856361546e-12;-6.24635605346970e-12;1.48514172797896e-12;2.87255376900597e-11;2.66541650434030e-10;1.23636748331456e-07;2.07147176918886e-10;2.53735481877728e-10;-6.42382012519843e-11;-5.52265744310593e-12;-6.51274788269531e-12;2.96921779597464e-08;2.11051912881497e-10;-5.57107422275848e-12;-7.88255008867253e-11;-8.72776664029242e-12;-1.70849492672918e-12;7.31664474458770e-12;1.34229534348312e-11;9.52599159800285e-11;1.04712435055321e-11;4.70392890283761e-12;2.24604632406300e-12;-1.38549828878925e-11;-3.65091039441142e-12;2.54097506322566e-09;1.03070076366328e-11;1.16738212808484e-11;-3.41489221159888e-12;3.83763798014015e-12;6.51714186187162e-11;2.22701675327682e-11;6.70198826630548e-12;-1.77497272035197e-11;-3.41680625735223e-12;6.10195449605329e-11;-1.79467820610169e-11;2.47464759315009e-12;-2.25159559691954e-12;1.16008864082691e-11;6.94033727999440e-12;2.64202822871364e-11;2.76253901593433e-12;-6.16242677617537e-12;3.61980660262513e-12;3.04401185655306e-12;2.01061041877090e-11;1.08934459835272e-11;-5.00416633834881e-12;-1.42634016193696e-12;-6.86900548370275e-13;-2.97105550147843e-12;1.02688827007938e-11]
Par(1:26)=Jac;
Jac=[4655.01770413196;1.71333559453361e-14;1.08501151633941e-12;2.09603034719955e-06;9.14473489217381e-11;1.21467348906618e-10;9.43096463434977e-11;-4.52990044619545e-05;-2.35409133577360e-14;-3.53715713340364e-12;-4.88426762582301e-05;1.68643492966204e-15;1.19235078270900e-13;-9.32858368898506e-05;9.01633825335500e-05;3.81196777364899e-05;4.29507711216065e-05;7.59307007511418e-13;1.16541765084759e-14;-3.12972331048806e-06;3.85385486697921e-15;-1.29021091121790e-06;1.37040276061248e-14;8.57086956698495e-15;-7.54346887610614e-16;-1.09778424553481e-05]
Par=[4252.88500074377/1.5;-1.37827489066409e-13;2.92218917147913e-14;3.02134244236416e-06;-1.92042584460810e-09;1.59464989149981e-11;-5.43931670776137e-10;-3.83238853721414e-05;-9.47032363608093e-15;3.48138928446930e-13;5.48672500388745e-05;-1.19945160614052e-14;-9.23270478771337e-13;-0.000117986675068781;7.45907739923180e-05;3.40853583216311e-05;3.95113826653639e-05;-3.17501984546639e-14;5.97438955459177e-13;-3.39505689927475e-06;3.21468007325878e-16;-7.59835944926648e-07;-2.17632932719860e-15;2.24707383970825e-13;-1.71794377075682e-13;-1.07862096716191e-05;3.00643121358029e-12;-6.75896918668713e-12;-7.23120927573010e-12;-3.13338224334405e-12;-5.70333338411154e-12;-4.71399079616664e-11;-1.44145216391483e-11;-1.52882803624321e-11;-2.96508942985382e-11;-2.94487755711762e-11;-2.73690025122374e-12;3.84265416130937e-12;-1.18552459369636e-11;-6.80235049864744e-12;-1.39217821020164e-11;9.13496482107963e-12;-1.32208096752258e-12;-8.07206242814938e-12;-1.21857732731509e-12;-1.88458462876974e-13;1.55363297443679e-11;-6.26393981042127e-12;-5.65721318215547e-12;-1.02729652641223e-11;1.36406528570562e-12;3.62635498935387e-11;2.78556646975855e-10;1.34539074584023e-07;1.76292224162427e-10;3.66345537170856e-10;-6.25570520343177e-11;-8.19450978596692e-12;-6.81620538534997e-12;1.27343348637112e-08;1.45000336818748e-10;-7.27503541547412e-12;-8.18654716958665e-11;-5.57828785405915e-12;-1.56231992873247e-12;8.70589911129794e-12;1.35123237437255e-11;1.49210094000480e-10;1.05541085384237e-11;4.26604698220543e-12;2.34604448542417e-12;-1.51559812587508e-11;-4.97713930213171e-12;1.92950042797039e-09;7.95377659465804e-12;1.34531578984713e-11;-5.41008420525447e-12;3.00751081465244e-12;7.76483826864590e-11;3.88848818611548e-11;5.97862800835379e-12;-1.92298949645739e-11;-1.97254761094753e-12;8.48266665093072e-11;-1.21111701048142e-11;2.82688388079233e-12;-3.32629561688839e-12;6.43761068758081e-12;2.86601693443955e-12;2.98504691483563e-11;3.26965151341246e-12;-8.74782155470250e-12;3.21787479286598e-12;1.96825701490464e-12;2.65151556871680e-11;1.31215368579908e-11;-6.40608657195221e-12;-1.56182578128226e-12;-5.56254157427690e-13;-2.83163875726295e-12;9.18035322064831e-12]
Par(1:26)=Jac;
Par(1)=Par(1)/1.25;
Par=[3664.93727650956;1.45323277072890e-14;1.22232910306214e-12;2.66600142516370e-06;7.44390224317670e-11;9.05203464769060e-11;9.93389019753411e-11;-0.000112396992211669;-2.32912707740382e-14;-3.75981262234052e-12;-4.28933222166812e-05;1.42382635891325e-15;1.12754158948667e-13;-0.000107561938388203;7.56766495053201e-05;4.48131343512839e-05;4.06105452439289e-05;8.11374923672174e-13;1.07605288329316e-14;-3.12236785989631e-06;4.07478757042662e-15;-1.30752334681709e-06;1.29875069650674e-14;8.42132394823369e-15;-8.14322159562560e-16;-1.05496424882978e-05;3.07413735720659e-12;-5.66139666074867e-12;-7.10976658512325e-12;-3.01241339409925e-12;-6.68290454605363e-12;-5.23269226276864e-11;-1.88511135657113e-11;-1.49129471049418e-11;-2.93904573270844e-11;-2.97680497507027e-11;-2.71743110637931e-12;4.30641214995284e-12;-1.42120193310881e-11;-7.15824131070048e-12;-1.28037472517043e-11;1.07395003911341e-11;-1.39398935648382e-12;-8.67473962082854e-12;-1.27382060764751e-12;-1.66739323529999e-13;1.59795432903805e-11;-7.16337456058210e-12;-6.24654724955137e-12;-1.36064196535478e-11;1.38070942015252e-12;3.98906108712918e-11;2.80488526160689e-10;1.48065108800546e-07;1.66845237518921e-10;3.48955322396057e-10;-5.92305030764900e-11;-6.43669808495410e-12;-6.63265271721010e-12;6.60802801811483e-09;1.82643724619116e-10;-7.10106242325691e-12;-8.40604074587576e-11;-5.60394760609571e-12;-1.56857347630720e-12;8.07467885778757e-12;1.53712232163025e-11;2.13561028985880e-10;1.31405707861705e-11;3.65665155533654e-12;2.20615338527374e-12;-1.54512459476614e-11;-7.13295516730735e-12;1.09829228666231e-09;8.34180498400645e-12;1.85036548317790e-11;-5.16891872610730e-12;3.84556536842685e-12;7.91771713610744e-11;3.82959585629130e-11;5.67048691311151e-12;-1.81923002880208e-11;-1.92803453026311e-12;8.81233984493931e-11;-1.38204813045042e-11;2.93693542278407e-12;-3.15601286836718e-12;5.88646728663443e-12;2.84690600209285e-12;3.17294241008701e-11;3.71364083046283e-12;-1.01971261039118e-11;3.18224813388644e-12;1.97821338640356e-12;3.29868442814944e-11;1.23910707932905e-11;-6.06137688610526e-12;-1.31463826672408e-12;-5.93724085181317e-13;-2.81142529535095e-12;7.73188736570490e-12]
Jac=[1981.98663981303;8.82742738773271e-14;-7.84400266693751e-12;1.56441723608090e-06;-2.53815825437643e-12;-1.62991620640507e-10;5.67879264373260e-10;-0.000885890467527815;1.35782178792181e-16;4.09109889704690e-12;0.000806144784140496;2.09624517954204e-13;-2.12936205236638e-15;-8.16255853034447e-05;9.04274602082854e-05;3.19658346859769e-05;4.79195221871666e-05;-9.54487337109806e-13;-6.26056600112385e-16;-2.91493841938105e-06;-3.10476620322005e-15;-3.36810155612357e-06;8.25283582153209e-15;2.49937147275345e-14;-2.47927830025039e-15;-1.11464522201037e-05]
Par(1:26)=Jac;
Par=[1460.58597747832;3.96958054325547e-14;-1.07717887276118e-12;2.26843687087287e-06;3.50586290255056e-14;-3.04309888022423e-11;3.60759256514475e-10;-0.000845909133650841;3.42805585342689e-17;-1.06283186888474e-12;0.000750934984889564;9.60409808310809e-14;-7.30172332117671e-15;-9.41814104604885e-05;7.87889923572891e-05;2.80024039308364e-05;4.58515144317179e-05;-8.21581357559913e-13;-2.19253246792348e-16;-2.92497956468320e-06;-2.13993197756126e-15;-3.40953771575080e-06;5.70182221073231e-15;2.38206419968975e-14;-1.00554449330156e-15;-1.08793332220237e-05;2.28500083489594e-12;-7.78966151074664e-13;-1.06715353708599e-11;-6.59836269396071e-12;-6.69633523357952e-12;-5.16553213232762e-10;-2.55883929831673e-11;-5.32525564618434e-12;-2.96002884529807e-10;-2.77540831008313e-10;-1.29776121236680e-12;1.15337685948268e-11;-6.58526759312784e-11;1.06167912246404e-11;-1.57097044415744e-11;1.37631351775533e-11;-8.54437285176026e-13;-4.38549624806468e-12;-1.04098314961623e-12;-1.46332077457384e-13;1.44651804192140e-11;-1.93691614090974e-11;-6.52931449911429e-12;-1.64921455756809e-11;1.46819179574561e-12;5.43407574617954e-11;2.06309321048236e-10;3.29765134904760e-08;-2.90845092440307e-09;3.22416054996100e-10;-1.75289608014232e-10;-7.93730451933714e-12;-3.23170924665634e-12;-2.34933930061763e-11;1.34817972546954e-10;-3.33511537668725e-12;-1.34289721508011e-11;-1.00170069510589e-11;-9.54271394717757e-13;1.15190500273982e-12;1.36104654797115e-11;1.29149025669511e-10;7.86538830391232e-12;6.07137339590421e-12;1.69137181630379e-12;-2.19122149304401e-11;-6.06952882332219e-12;1.12298736501153e-09;-9.85138201702307e-13;1.08406197873767e-11;-1.91679782228010e-11;1.57435144540586e-12;2.46006634547138e-11;2.71347569969912e-11;3.89188106231203e-12;-8.03590266036921e-11;-3.71275213297301e-12;1.18491030299731e-10;-3.73875438126902e-11;2.95670300235682e-13;-2.12876861787683e-12;1.28014162581971e-11;5.18808539119235e-12;3.30859893608747e-11;1.22074615433959e-12;-3.72296007094663e-12;1.88114485705948e-11;4.20578859420565e-13;3.45785634753771e-11;5.11239834580419e-12;-7.14729816090821e-12;-6.81486117002191e-13;-7.23351138127237e-13;-1.05264783766225e-12;1.64734136275957e-12]
Par=[1054.69352470106;4.16942443364867e-14;3.31833391472120e-12;2.38250879158429e-06;-1.16762327731754e-16;-1.49879840565883e-12;-7.84128407929985e-12;-0.000572176958089156;-4.35065158119621e-18;-4.55878409484445e-14;0.000531239752113844;1.05561842673366e-13;2.29706598532169e-15;-9.39492700225694e-05;7.96255519668750e-05;2.86729810872578e-05;4.60055049804884e-05;-5.32028708360960e-13;-2.16854624715078e-14;-2.53651723304109e-06;-1.04341963429374e-15;-3.52997040235208e-06;-2.26366089032687e-16;1.74647347447060e-17;-8.55056849465516e-16;-1.10961670569935e-05;7.00242172570306e-13;-4.49794204552310e-13;-1.20243363570230e-11;-4.61643859963682e-12;-6.22084135180315e-12;-6.85909944868503e-10;-1.89608993849497e-10;-1.70741018477888e-10;-3.03850471390300e-10;-5.12756574828857e-10;-1.26601052477050e-12;5.17286914388530e-13;-7.31015577130148e-11;3.18859389208942e-11;-2.56016137576127e-12;1.32732970859826e-11;1.95696584862524e-12;-7.93328380715855e-13;1.55903805788752e-14;-6.87190367188395e-14;2.05096966321803e-11;-1.34987639072225e-11;-6.02774011179077e-12;-1.35302431879486e-11;7.11555088349702e-13;3.74154249010457e-10;7.50222306624152e-09;1.40514353115688e-08;-1.67605748686734e-09;-1.02581515061990e-08;-3.53575784717895e-11;-7.10292971216730e-12;-2.17244083130633e-13;4.95631858232651e-11;3.53343184310546e-11;-6.99837563683611e-13;1.91174980867063e-11;7.07640380047066e-12;-3.52852605631790e-12;4.87643402497754e-14;-2.83135636376363e-12;-4.24727148302740e-10;-6.28985662348701e-13;-2.44789446440834e-11;2.66598377895597e-13;5.19610163666907e-13;-7.88939570605502e-13;1.07475509253019e-09;-3.35071732271225e-14;2.08040269215578e-11;-7.47124245988579e-11;2.15665250709767e-13;8.19985982815494e-13;6.44891696925593e-14;7.49443441310332e-12;-1.26076620458780e-10;-5.56286554894836e-14;1.30801393155751e-10;-3.74193655625894e-11;1.32417736603551e-13;-1.21387844053203e-12;1.01165604735484e-13;2.11294753034404e-11;2.57101138077911e-11;-1.91148214994692e-13;-2.66570878730849e-12;4.42658540618287e-12;7.78403282728533e-14;4.27079295459450e-11;2.72194804469662e-12;-7.93772187461083e-12;-2.17321337722317e-14;6.61744251185231e-13;-2.81403938439949e-12;4.49331083559559e-12]

%No more par(1)=ini
Par=[4.16942443364867e-14;3.31833391472120e-12;2.38250879158429e-06;-1.16762327731754e-16;-1.49879840565883e-12;-7.84128407929985e-12;-0.000572176958089156;-4.35065158119621e-18;-4.55878409484445e-14;0.000531239752113844;1.05561842673366e-13;2.29706598532169e-15;-9.39492700225694e-05;7.96255519668750e-05;2.86729810872578e-05;4.60055049804884e-05;-5.32028708360960e-13;-2.16854624715078e-14;-2.53651723304109e-06;-1.04341963429374e-15;-3.52997040235208e-06;-2.26366089032687e-16;1.74647347447060e-17;-8.55056849465516e-16;-1.10961670569935e-05;7.00242172570306e-13;-4.49794204552310e-13;-1.20243363570230e-11;-4.61643859963682e-12;-6.22084135180315e-12;-6.85909944868503e-10;-1.89608993849497e-10;-1.70741018477888e-10;-3.03850471390300e-10;-5.12756574828857e-10;-1.26601052477050e-12;5.17286914388530e-13;-7.31015577130148e-11;3.18859389208942e-11;-2.56016137576127e-12;1.32732970859826e-11;1.95696584862524e-12;-7.93328380715855e-13;1.55903805788752e-14;-6.87190367188395e-14;2.05096966321803e-11;-1.34987639072225e-11;-6.02774011179077e-12;-1.35302431879486e-11;7.11555088349702e-13;3.74154249010457e-10;7.50222306624152e-09;1.40514353115688e-08;-1.67605748686734e-09;-1.02581515061990e-08;-3.53575784717895e-11;-7.10292971216730e-12;-2.17244083130633e-13;4.95631858232651e-11;3.53343184310546e-11;-6.99837563683611e-13;1.91174980867063e-11;7.07640380047066e-12;-3.52852605631790e-12;4.87643402497754e-14;-2.83135636376363e-12;-4.24727148302740e-10;-6.28985662348701e-13;-2.44789446440834e-11;2.66598377895597e-13;5.19610163666907e-13;-7.88939570605502e-13;1.07475509253019e-09;-3.35071732271225e-14;2.08040269215578e-11;-7.47124245988579e-11;2.15665250709767e-13;8.19985982815494e-13;6.44891696925593e-14;7.49443441310332e-12;-1.26076620458780e-10;-5.56286554894836e-14;1.30801393155751e-10;-3.74193655625894e-11;1.32417736603551e-13;-1.21387844053203e-12;1.01165604735484e-13;2.11294753034404e-11;2.57101138077911e-11;-1.91148214994692e-13;-2.66570878730849e-12;4.42658540618287e-12;7.78403282728533e-14;4.27079295459450e-11;2.72194804469662e-12;-7.93772187461083e-12;-2.17321337722317e-14;6.61744251185231e-13;-2.81403938439949e-12;4.49331083559559e-12]
Par=[3.57895457359132e-16;2.19776452950452e-12;2.91721230848664e-06;-1.74869050524177e-19;9.02853831234013e-20;-2.46454422514063e-13;-0.000681559538187157;-3.48131551125447e-18;3.03534054934064e-15;0.000638481197942907;-6.03161398052878e-18;1.02471418176222e-18;-9.61931130007584e-05;7.96291778709893e-05;4.06182637235567e-05;2.69762057709397e-05;-9.42427882581993e-18;-1.43356589096556e-19;-1.69780954610482e-06;-9.84926334269927e-17;-6.96057169713576e-07;1.28236913175946e-22;-3.99364813120042e-20;5.22493199562587e-16;-1.15545889207622e-05;1.70615407877486e-13;-3.88463323418505e-12;-2.15352350515329e-11;5.66431306580376e-13;-2.77779488914726e-15;-8.50197882635706e-13;-2.19348500541418e-10;-1.26494957319748e-15;-6.32222912699872e-10;-1.27520265977498e-14;4.88996399324605e-17;1.00309418211560e-14;-5.26109403672419e-11;6.84830412273124e-11;-2.39775480030953e-15;1.01648442933489e-10;7.87208992783932e-16;-5.34529851593347e-17;4.62061598146245e-18;2.52248059845711e-17;2.00571406030025e-10;-7.35136664200690e-11;1.01107579867545e-12;-2.05539638571893e-11;-5.56031374585040e-15;-1.14032061447832e-09;2.03797779681421e-08;1.00429699456444e-08;3.49629894179633e-10;-2.06255031234588e-08;-3.57564866800855e-09;5.27384444003481e-13;-1.71309927517073e-13;1.77713781226756e-16;1.02968644419522e-09;-1.05805688989749e-14;4.30423704081003e-13;-4.31071976001774e-17;-2.83484883647909e-15;-1.23511985113831e-14;-1.53420945152957e-15;6.32632293160032e-10;3.53139500734944e-16;-1.49062322540720e-13;-1.94602149272716e-15;-2.70815170620015e-17;-1.52965720788562e-17;1.17565373311788e-09;-1.13416548818881e-15;2.17595784734014e-11;3.71364835980883e-16;-1.99233283920844e-13;8.05094987671937e-13;-1.14203730422595e-14;1.80771927392797e-10;-3.42355043953589e-10;6.79020727766450e-19;6.79809285984360e-11;-1.16123862146892e-10;-7.54414362907424e-18;-6.44315681020705e-15;-9.49769084579235e-17;6.52449819641847e-11;1.04535650213798e-11;8.24650919858419e-16;2.12993858007774e-10;1.42097251949109e-13;-5.47030860586992e-19;-2.64831885468100e-15;-2.37694412247634e-16;-1.30234517704815e-16;3.48916603476711e-15;-3.30856331107225e-12;-2.47639151932094e-12;-1.12439402847361e-10]
Par=[1.08788006796825e-24;1.00016654989399e-24;3.47231170418797e-06;1.29868502414507e-26;4.88624972143440e-28;-4.17483717633520e-20;-0.000791646968960071;3.78428102939598e-26;-9.00341789880448e-21;0.000920850502743092;-3.10276750798453e-33;-2.43216934626296e-22;-0.000100995430466242;8.10605794849896e-05;3.29753226981123e-05;3.32055826683392e-05;-3.74369122962240e-27;-1.57088562256977e-22;-1.23929560944211e-06;1.54854867232725e-31;8.49951215943475e-07;8.24044658911237e-35;2.76438158077051e-28;-1.87921664916293e-17;-1.01351888882252e-05;5.18957853424483e-11;-2.33030566640172e-11;-2.83415912729087e-11;8.08965469008923e-29;-7.33513250917091e-29;7.06171037116604e-30;-3.10867604098722e-09;-4.44682257982137e-26;-1.17434518496350e-09;-9.79590804670437e-19;4.18128223724650e-32;4.03106253764490e-29;-9.38190298181348e-11;4.32700957890714e-18;7.96798618660199e-22;1.04014010916323e-10;-1.45095713284577e-23;-2.62783932452203e-18;1.66888032263158e-25;-6.36187656343929e-11;1.80243047777822e-10;-1.00770051853952e-10;4.90287105811815e-15;-3.36621344192835e-11;-7.92695221695255e-21;2.99372305324953e-09;4.08650203058687e-08;8.97304813167621e-09;3.79900167608768e-09;-4.60274717316329e-08;-4.61161502479196e-09;2.04003762155830e-21;3.67005001655732e-20;9.22647271710370e-27;5.41245271614902e-09;6.62740438420717e-20;-8.24986015792764e-29;6.31945657537015e-30;7.70002682150748e-25;-2.27745804188908e-18;-1.53811983418764e-33;3.53880919495865e-10;2.76374769461554e-27;6.30743783184525e-20;-2.12467596175532e-21;-1.39816386181444e-22;8.64307813027444e-23;1.71164211748089e-09;5.75155505896683e-16;-8.56387303568856e-22;2.50515900937401e-10;-1.10728769602253e-23;-4.09998163241263e-31;-1.23377781252218e-25;2.60938923421032e-10;-7.59838727451868e-11;-8.27412782471277e-31;6.42159530356465e-11;-1.31531900719341e-10;6.03414197708929e-32;1.43022984343540e-25;7.66150647365070e-26;1.06531502407512e-10;-1.00816907770403e-21;-1.25650926429669e-31;3.33895167429608e-10;-2.57285662745157e-11;4.69493444858728e-31;-2.06524814577257e-28;-1.66213638727884e-22;-9.85277392531334e-24;3.83664011175963e-11;-1.74334240517491e-11;6.86752395286793e-19;-1.17739832588341e-10]
  
%lstx*10

% Par=Pars(:,16);
lst_ODE_model(Par,1)
drawnow

% options = optimset('Display','iter','MaxFunEvals',5000,'MaxIter',5000);
% new_par=fminsearch(@lst_ODE_model,Par,options,0)
% lst_ODE_model(new_par,1)
% save('new_par','new_par')

% clear Lsts Pars
% new_par=Par;
% for n=20:450
% options = optimset('Display','final','MaxFunEvals',5000,'MaxIter',5000);
% new_par=fminsearch(@lst_ODE_model,new_par,options,0);
% save('new_par','new_par')
% Lsts(n)=lst_ODE_model(new_par,1);
% Pars(:,n)=new_par;
% figure(100); plot(Lsts); title('Quadwc-v2')
% drawnow
% save('Quadwc_v2')
% end

return

function z=lst_ODE_model(Par,g)
ok=0; lst1=0; lsti=0;lstx=0;
% ini=floor(Par(1));
% ini=ini*(ini<=1981)+1981*(ini>1981);
% Par=Par(2:end);
% ini(ini>9e4)=9e4;
% ini(ini<0)=0;

ini=0;

load('Met_Pathwayv2_S80000_P20000_Q20000_noDil')
temp=output(:,5);
output(:,5)=output(:,6);
output(:,6)=temp;

Tspan=ini:100000;
options = odeset('RelTol',1e-6,'AbsTol',1e-6,'Events',@odeEvents);
tic
[t,y] = ode15s(@MetPathODE,Tspan,output(ini+1,2:end),options,Par); %[80000 20000 20000 10 10]
if or(t(end)<Tspan(end),any(imag(y)>0))
    ok=ok+1e14;
end    
   if ok==0 
    if g==1
        figure(10)
        newcolors = [0.83 0.14 0.14
            1.00 0.54 0.00
            0.47 0.25 0.80
            0.25 0.80 0.54
            0.54 0.54 0.54];
        
        colororder(newcolors)
        plot(t,y, 'LineWidth', 1.5)
        hold on
        plot(output(:,1),output(:,2:end),'--', 'LineWidth', 1.5)
        hold off
        legend('S','P','Q','R','T')
        
        
    end
    
    dadosS=interp1(t,y,output(:,1));
    lst=(dadosS-output(:,2:end)).^2;
    lst(isnan(lst))=0;
    lst1=sum(sum(lst));
    if any(y<0,'All')
        lst1=lst1*10;
%         'negativos'
    end
   end
     %%

load('Met_Pathwayv2_S80000_P20000_Q20000_Dil0005In1.mat')
temp=output(:,5);
output(:,5)=output(:,6);
output(:,6)=temp;

Tspan=0:50000;
options = odeset('RelTol',1e-6,'AbsTol',1e-6);
[t,y] = ode15s(@MetPathODE_flow,Tspan,[80000 20000 20000 10 10],options,Par,[1 0.0005]);
if t(end)<Tspan(end)
    ok=ok+1e12
end

if g==1
    figure(11)
    newcolors = [0.83 0.14 0.14
             1.00 0.54 0.00
             0.47 0.25 0.80
             0.25 0.80 0.54
             0.54 0.54 0.54];
         
         colororder(newcolors)
    plot(t,y, 'LineWidth', 1.5)
    hold on
    plot(output(:,1),output(:,2:end),'--', 'LineWidth', 1.5)
    hold off
    assignin('base','output',output(1:2000:end,:))
assignin('base','ty',[t(1:500:end) y(1:500:end,:)])
end

dadosS=interp1(t,y,output(:,1));
lst=(dadosS-output(:,2:end)).^2;
lst(isnan(lst))=0;
lst2=sum(sum(lst));
if any(y<0,'All')
        lst2=lst2*10;
%         'negativos'
    end
%%
Tspan=0:50000;
options = odeset('RelTol',1e-6,'AbsTol',1e-6);
[t,y] = ode15s(@MetPathODE_flow,Tspan,[80000 20000 20000 10 10],options,Par,[.1 0.0005]);
if t(end)<Tspan(end)
    ok=ok+3e12
end
if g==1
    figure(12)
    newcolors = [0.83 0.14 0.14
             1.00 0.54 0.00
             0.47 0.25 0.80
             0.25 0.80 0.54
             0.54 0.54 0.54];
         
         colororder(newcolors)
    plot(t,y, 'LineWidth', 1.5)
    ylim([-1000 4000])
    
end
if any(y<0,'All')
        lstx=lstx+sum(sum(((y<0).*y).^2));
%         'negativos .1'
end
%%

Tspan=0:50000;
options = odeset('RelTol',1e-6,'AbsTol',1e-6);
[t,y] = ode15s(@MetPathODE_flow,Tspan,[80000 20000 20000 10 10],options,Par,[.5 0.0005]);
if t(end)<Tspan(end)
    ok=ok+4e12
end
if g==1
    figure(13)
    newcolors = [0.83 0.14 0.14
             1.00 0.54 0.00
             0.47 0.25 0.80
             0.25 0.80 0.54
             0.54 0.54 0.54];
         
         colororder(newcolors)
    plot(t,y, 'LineWidth', 1.5)
    ylim([0 3000])
    
end
if any(y<0,'All')
        lstx=lstx+sum(sum(((y<0).*y).^2));
%         'negativos .5'
end

%%
% lsti=ini*1e7;

if g==1
    [lst1 lst2 lsti lstx*10]
end

z=lst1+lst2+lstx*10+ok;
end

function dxdt=MetPathODE(t,x,p) %This is the ODE function
ss=[0.0000   0.0000   0.0000    4.3226    7.6794]*1e4;
Pr=reshape(p(1:25),5,5);
H=reshape(p(26:100),5,15);

X=(x-ss');
X2=[X(1)*X(1)
    X(1)*X(2)
    X(1)*X(3)
    X(1)*X(4)
    X(1)*X(5)
    X(2)*X(2)
    X(2)*X(3)
    X(2)*X(4)
    X(2)*X(5)
    X(3)*X(3)
    X(3)*X(4)
    X(3)*X(5)
    X(4)*X(4)
    X(4)*X(5)
    X(5)*X(5)];

dxdt=Pr*X+H*X2;

end
function dxdt=MetPathODE_flow(t,x,p,flow) %This is the ODE function
in=flow(1);
dil=flow(2);
ss=[0.0000   0.0000   0.0000    4.3226    7.6794]*1e4;
Pr=reshape(p(1:25),5,5);
H=reshape(p(26:100),5,15);

X=(x-ss');
X2=[X(1)*X(1)
    X(1)*X(2)
    X(1)*X(3)
    X(1)*X(4)
    X(1)*X(5)
    X(2)*X(2)
    X(2)*X(3)
    X(2)*X(4)
    X(2)*X(5)
    X(3)*X(3)
    X(3)*X(4)
    X(3)*X(5)
    X(4)*X(4)
    X(4)*X(5)
    X(5)*X(5)];

dxdt=Pr*X+H*X2;

dxdt(1)=dxdt(1)+in;
dxdt=dxdt-x*dil;

end
function [value,isterminal,direction] = odeEvents(t,y,Par,SSa)
x=toc-10;
if x<0
    x=0;
end

value = x;     % Detect height = 0
isterminal = 1;   % Stop the integration
direction = 0;   
end
